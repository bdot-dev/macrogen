<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="macrogen.www.mapper.IntrstPrductMapper">

	<sql id="list_where" >
		<if test="userSn != null">
			AND ti.user_sn = #{userSn}
		</if>
	</sql>

	<select id="list" parameterType="intrstPrductVo" resultType="intrstPrductVo">
		<include refid="paging.countTop" />
		SELECT
			tp.*,
			(SELECT tc.code_nm FROM tb_code tc WHERE tp.prduct_knd_code = tc.code ) prduct_knd_code_nm,
		FROM
			tb_intrst_prduct ti
		LEFT JOIN
			tb_prduct tp
		ON
			ti.prduct_sn = tp.prduct_sn
		WHERE 1 = 1
		<include refid="list_where" />
		order by ti.regist_dt desc
		<include refid="paging.countBottom"/>
	</select>

	<select id="count" parameterType="intrstPrductVo" resultType="int">
		SELECT
			count(*)
		FROM
			tb_intrst_prduct ti
		LEFT JOIN
			tb_prduct tp
		ON
			ti.prduct_sn = tp.prduct_sn
		WHERE 1 = 1
		<include refid="list_where" />
	</select>

	<insert id="insert" parameterType="intrstPrductVo">
		INSERT INTO tb_intrst_prduct(
			user_sn, prduct_sn, regist_dt, register_sn, updt_dt, updusr_sn
		) VALUES(
			#{userSn}, #{prductSn}, now(), #{registerSn}, now(), #{updusrSn}
		)
	</insert>

	<delete id="delete" parameterType="intrstPrductVo">
		DELETE FROM tb_intrst_prduct WHERE user_sn = #{userSn} and prduct_sn = #{prductSn}
	</delete>

</mapper>
